{"ast":null,"code":"var _jsxFileName = \"/home/feechka-patrick/Desktop/course-work/client/src/pages/Auth.js\",\n  _s = $RefreshSig$();\nimport React, { useContext, useState, useEffect } from 'react';\nimport { Button, Card, Container, Form } from 'react-bootstrap';\nimport { LOGIN_ROUTE, MAIN_ROUTE, REGISTRATION_ROUTE } from '../utils/consts';\nimport { NavLink, useLocation, useHistory } from \"react-router-dom\";\nimport { decodeToken, getGamesByUser, login, registration } from '../http/userAPI';\nimport { Context } from \"../index\";\nimport { useInput } from '../components/Validation';\nimport { useAppSelector } from '../store/hooks';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Auth = () => {\n  _s();\n  const {\n    user\n  } = useContext(Context);\n  const location = useLocation();\n  const history = useHistory();\n  const isLogin = location.pathname === LOGIN_ROUTE;\n  const email = useInput('', {\n    isEmpty: true,\n    minLength: 5,\n    isEmail: true\n  });\n  const password = useInput('', {\n    isEmpty: true,\n    minLength: 3\n  });\n  const {\n    _user\n  } = useAppSelector(store => store);\n  const signIn = async () => {\n    debugger;\n    try {\n      let data;\n      if (isLogin) {\n        data = await login(email.value, password.value);\n      } else {\n        data = await registration(email.value, password.value);\n      }\n      dispatch(setAuth({\n        ...state.auth,\n        user: _user\n      }));\n      user.setUser(user);\n      user.setIsAuth(true);\n      {/* UPDATE EMAIL */}\n      let userData = await decodeToken(String(data.data));\n      user.setEmail(userData.data.email);\n      {/* UPDATE USER ID */}\n      user.setId(userData.data.id);\n      {/* UPDATE GAME HISTORY */}\n      data = await getGamesByUser(user.email);\n      let games = [];\n      {\n        data.data.map((game, i) => games.push({\n          winner: game.winner,\n          time: game.time\n        }));\n      }\n      user.setGames(games);\n      history.push(MAIN_ROUTE);\n    } catch (e) {\n      alert(e.response.data.message);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(Container, {\n    className: \"d-flex justify-content-center align-items-center\",\n    style: {\n      height: window.innerHeight - 54\n    },\n    children: /*#__PURE__*/_jsxDEV(Card, {\n      style: {\n        width: 600\n      },\n      className: \"p-5\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"m-auto\",\n        children: isLogin ? \"Sign in to the site\" : \"Registration\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(Form, {\n        className: \"d-flex flex-column\",\n        children: [/*#__PURE__*/_jsxDEV(Form.Control, {\n          className: \"mt-3\",\n          placeholder: \"Enter your email...\",\n          value: email.value,\n          onChange: e => email.onChange(e),\n          onBlur: e => email.onBlur(e)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 6\n        }, this), !isLogin && email.isDirty && email.isEmpty && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            color: 'red'\n          },\n          children: \"Email cannot be empty\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 8\n        }, this), !isLogin && email.isDirty && email.minLengthError && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            color: 'red'\n          },\n          children: \"Email cannot be less 5 symbols\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 8\n        }, this), !isLogin && email.isDirty && email.emailError && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            color: 'red'\n          },\n          children: \"Incorrect email\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 8\n        }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n          className: \"mt-3\",\n          type: \"password\",\n          id: \"inputPassword5\",\n          \"aria-describedby\": \"passwordHelpBlock\",\n          placeholder: \"Enter your password...\",\n          value: password.value,\n          onChange: e => password.onChange(e),\n          onBlur: e => password.onBlur(e)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 6\n        }, this), !isLogin && password.isDirty && password.isEmpty && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            color: 'red'\n          },\n          children: \"Password cannot be empty\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 8\n        }, this), !isLogin && password.isDirty && password.minLengthError && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            color: 'red'\n          },\n          children: \"Password cannot be less 3 and more 8 symbols\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 8\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        disabled: false,\n        variant: \"outline-success\",\n        className: \"mt-3\",\n        onClick: signIn,\n        children: isLogin ? \"Sign in\" : \"Log up\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 5\n      }, this), isLogin ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-3\",\n        children: [\"Don't have an account yet?\", /*#__PURE__*/_jsxDEV(NavLink, {\n          to: REGISTRATION_ROUTE,\n          children: \" Create an account.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 6\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-3\",\n        children: [\"Already have an account?\", /*#__PURE__*/_jsxDEV(NavLink, {\n          to: LOGIN_ROUTE,\n          children: \" Sign in\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 6\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 4\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 3\n  }, this);\n};\n_s(Auth, \"2pLsMVRiN3bkMNnjuUT3DSHduGs=\", false, function () {\n  return [useLocation, useHistory, useInput, useInput, useAppSelector];\n});\n_c = Auth;\nexport default Auth;\nvar _c;\n$RefreshReg$(_c, \"Auth\");","map":{"version":3,"names":["React","useContext","useState","useEffect","Button","Card","Container","Form","LOGIN_ROUTE","MAIN_ROUTE","REGISTRATION_ROUTE","NavLink","useLocation","useHistory","decodeToken","getGamesByUser","login","registration","Context","useInput","useAppSelector","Auth","user","location","history","isLogin","pathname","email","isEmpty","minLength","isEmail","password","_user","store","signIn","data","value","dispatch","setAuth","state","auth","setUser","setIsAuth","userData","String","setEmail","setId","id","games","map","game","i","push","winner","time","setGames","e","alert","response","message","height","window","innerHeight","width","onChange","onBlur","isDirty","color","minLengthError","emailError"],"sources":["/home/feechka-patrick/Desktop/course-work/client/src/pages/Auth.js"],"sourcesContent":["import React, { useContext, useState, useEffect } from 'react';\nimport { Button, Card, Container, Form } from 'react-bootstrap';\nimport { LOGIN_ROUTE, MAIN_ROUTE, REGISTRATION_ROUTE } from '../utils/consts';\nimport { NavLink, useLocation, useHistory} from \"react-router-dom\";\nimport { decodeToken, getGamesByUser, login, registration } from '../http/userAPI';\nimport {Context} from \"../index\";\nimport { useInput } from '../components/Validation';\nimport { useAppSelector } from '../store/hooks';\n\nconst Auth = () => {\n\tconst { user } = useContext(Context)\n\tconst location = useLocation()\n\tconst history = useHistory()\n\tconst isLogin = location.pathname === LOGIN_ROUTE\n\tconst email = useInput('', {isEmpty: true, minLength: 5, isEmail:true})\n\tconst password = useInput('', {isEmpty: true, minLength: 3})\n\n\tconst { _user } = useAppSelector((store) => store);\n\n\tconst signIn = async () => {\n\t\tdebugger\n\t\ttry {\n\t\t\tlet data;\n\t\t\tif (isLogin) {\n\t\t\t\tdata = await login(email.value, password.value);\n\t\t\t} else {\n\t\t\t\tdata = await registration(email.value, password.value);\n\t\t\t}\n\n\t\t\tdispatch(setAuth({ ...state.auth, user: _user }));\n\t\t\tuser.setUser(user)\n\t\t\tuser.setIsAuth(true)\n\n\t\t\t{/* UPDATE EMAIL */}\n\t\t\tlet userData = await decodeToken(String(data.data))\n\t\t\tuser.setEmail(userData.data.email)\n\n\t\t\t{/* UPDATE USER ID */}\n\t\t\tuser.setId(userData.data.id)\n\n\t\t\t{/* UPDATE GAME HISTORY */}\n\t\t\tdata = await getGamesByUser(user.email)\n\t\t\tlet games = []\n\t\t\t{data.data.map((game, i) =>\n\t\t\t\tgames.push({winner: game.winner, time: game.time})\n\t\t\t)}\n\t\t\tuser.setGames(games)\n\n\t\t\thistory.push(MAIN_ROUTE)\n\t\t} catch (e) {\n\t\t\talert(e.response.data.message)\n\t\t}\n\t}\n\n\treturn (\n\t\t<Container\n\t\t\tclassName=\"d-flex justify-content-center align-items-center\"\n\t\t\tstyle={{ height: window.innerHeight - 54 }}>\n\t\t\t<Card style={{ width: 600 }} className=\"p-5\">\n\t\t\t\t<h2 className=\"m-auto\">{isLogin ? \"Sign in to the site\" : \"Registration\"}</h2>\n\t\t\t\t<Form className=\"d-flex flex-column\">\n\t\t\t\t\t<Form.Control\n\t\t\t\t\t\tclassName=\"mt-3\"\n\t\t\t\t\t\tplaceholder=\"Enter your email...\"\n\t\t\t\t\t\tvalue={email.value}\n\t\t\t\t\t\tonChange={e => email.onChange(e)}\n\t\t\t\t\t\tonBlur={e => email.onBlur(e)}\n\t\t\t\t\t/>\n\t\t\t\t\t{(!isLogin && email.isDirty && email.isEmpty) && \n\t\t\t\t\t\t\t<div style={{color:'red'} }>Email cannot be empty</div>}\n\t\t\t\t\t{(!isLogin && email.isDirty && email.minLengthError) && \n\t\t\t\t\t\t\t<div style={{color:'red'} }>Email cannot be less 5 symbols</div>}\n\t\t\t\t\t{(!isLogin && email.isDirty && email.emailError) && \n\t\t\t\t\t\t\t<div style={{color:'red'} }>Incorrect email</div>}\t\t\n\t\t\t\t\t<Form.Control\n\t\t\t\t\t\tclassName=\"mt-3\"\n\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\tid=\"inputPassword5\"\n\t\t\t\t\t\taria-describedby=\"passwordHelpBlock\"\n\t\t\t\t\t\tplaceholder=\"Enter your password...\"\n\t\t\t\t\t\tvalue={password.value}\n\t\t\t\t\t\tonChange={e => password.onChange(e)}\n\t\t\t\t\t\tonBlur={e => password.onBlur(e)}\n\t\t\t\t\t/>\n\t\t\t\t\t{(!isLogin && password.isDirty && password.isEmpty) && \n\t\t\t\t\t\t\t<div style={{color:'red'} }>Password cannot be empty</div>}\n\t\t\t\t\t{(!isLogin && password.isDirty && password.minLengthError) && \n\t\t\t\t\t\t\t<div style={{color:'red'} }>Password cannot be less 3 and more 8 symbols</div>}\n\t\t\t\t</Form>\n\n\t\t\t\t<Button\n\t\t\t\t\tdisabled={false}\n\t\t\t\t\tvariant={\"outline-success\"}\n\t\t\t\t\tclassName=\"mt-3\"\n\t\t\t\t\tonClick={signIn}>\n\t\t\t\t\t{isLogin ? \"Sign in\" : \"Log up\"}\n\t\t\t\t</Button>\n\n\t\t\t\t{isLogin ?\n\t\t\t\t\t<div className=\"mt-3\">Don't have an account yet?\n\t\t\t\t\t\t<NavLink to={REGISTRATION_ROUTE}> Create an account.</NavLink>\n\t\t\t\t\t</div>\n\t\t\t\t\t:\n\t\t\t\t\t<div className=\"mt-3\">Already have an account?\n\t\t\t\t\t\t<NavLink to={LOGIN_ROUTE}> Sign in</NavLink>\n\t\t\t\t\t</div>}\n\t\t\t</Card>\n\n\t\t</Container>\n\t);\n}\n\nexport default Auth;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}